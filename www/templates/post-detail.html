<ion-view class="comment-list single-post" id="post-detail" view-title="PHOTO">
    <ion-header-bar align-title="left" class="bar-subheader post-header">
        <a href="#">
            <div class="profile-image" style="background-image: url( {{ photoPath( post.user.profile_img_path, 's' ) }} )" ng-click="goAccount(post.user.slug)"></div>
            <div class="user-name" ng-click="goAccount(post.user.slug)">{{ post.user.first_name }} {{ post.user.last_name }}</div>
        </a>
        <span class="time-ago grey-small-font" am-time-ago="post.created_at | amUtc" ng-if="post"></span>
        <ion-spinner icon="ios-small" ng-if="!post"></ion-spinner>
    </ion-header-bar>
    <ion-content>
        <div class="update-notification" ng-if="!clientVersionUpToDate">
            New features are added. Let's update an app!
        </div>
        <div class="post-image">
            <img ng-src="{{ photoPath( post.photos[0].img_path, 'l' ) }}">
        </div>
        <div class="button-group">
            <button class= "button button-clear button-dark icon" ng-click="likeClicked()" ng-class="liked ? 'ion-ios-heart' : 'ion-ios-heart-outline'"></button>
            <button class="button button-clear button-dark icon ion-ios-chatbubble-outline" ng-click="focusComment()"></button>
        </div>
        <hr size="1" color="#e7e7e7">
        <div class="stats">
            <p class="likes-count" ng-click="goPostLikers(post.id)"><i class="ion-ios-heart"></i> {{ likesCount }} likes</p>
        </div>
        <p class="content" ng-bind-html="linkHashTag(post.content) | unsafe"></p>
        <p class="load-more grey-small-font" ng-click="loadMoreComments()" ng-if="commentsHiddenCount">load previous comments ({{ commentsHiddenCount }})</p>
        <ion-list>
            <ion-item class="item item-avatar item-text-wrap" ng-repeat="comment in post.latest_ten_comments" href="#">
                <img ng-click="goAccount(comment.user.slug)" ng-src="{{ photoPath( comment.user.profile_img_path, 's' ) }}" class="profile-image">
                <div ng-click="goAccount(comment.user.slug)" class="user-name">{{ comment.user.first_name }} {{ comment.user.last_name }}</div>
                <p>{{ comment.content }}</p>
                <span class="time-ago grey-small-font" am-time-ago="comment.created_at | amUtc"></span>
                <ion-option-button class="button-assertive" ng-click="remComment($index)" ng-if="ownComment($index)">Delete</ion-option-button>
            </ion-item>
        </ion-list>
        <form name="commentForm" ng-submit="submitComment()">
            <div class="list">
                <div class="item item-input-inset">
                    <label class="item-input-wrapper">
                        <input name="comment" type="text" id="comment" placeholder="Write a comment..." ng-model="comment.content">
                    </label>
                    <button class="button button-small">
                        Submit
                    </button>
                </div>
            </div>
        </form>
    </ion-content>
</ion-view>